namespace = uma_bour_arc

#导！
event = {
	id = uma_bour_arc.9
    hide_window = yes
    is_triggered_only = yes
    fire_only_once = yes

	immediate = {
		random_country = {
			limit = { is_country_type = global_event }
			country_event = {
				id = uma_bour_arc.0
			}
		}
	}

}

#创建船专用的敌对国家
country_event = {
	id = uma_bour_arc.0
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOT = {
			has_global_flag = uma_has_created_bourbon_country
		}
	}

	immediate = {
		set_global_flag = uma_has_created_bourbon_country
		create_country = {
			name = "uma_bour_arc_acient_defender"
			type = uma_bourbon_arc_country
			ignore_initial_colony_error = yes
			authority = random
			flag = random
			name_list = random #?
			origin = origin_default
			effect = {
				save_global_event_target_as = uma_bourbon_arc_fleet_country
			}

		}
	}

}

#创建船（30K（我感觉会有300K））
planet_event = {
	id = uma_bour_arc.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		create_fleet = {
			name = "uma_bour_arc_acient_defender" #远古智械守卫者
			effect = {
				set_owner = event_target:uma_bourbon_arc_fleet_country
				while = {
					count = 20
					create_ship = {
						name = random
						design = NAME_Warder_of_the_Ruins
						upgradable = no
					}
				}
				set_location = {
					target = event_target:uma_bourbon_arc_anomaly_here
					distance = 5
					angle = random
				}
			}
		}
	}
}

ship_event = {
	id = uma_bour_arc.2
	title = uma_bour_arc.2.title
	desc = uma_bour_arc.2.desc
#	picture =
	is_triggered_only = yes
	location = from
#from = planet
	option = {
		name = uma_bour_arc.2.a #Alright,What we can do is only wait here
		#这里是要用from吗?
		root = {
			save_event_target_as = uma_bou_ship
			ship_event = {
				id = uma_bour_arc.3
				days = 10
				random = 2
			}
		}
	}
}

ship_event = {
	id = uma_bour_arc.3
	title = uma_bour_arc.3.title
	desc = uma_bour_arc.3.desc
	is_triggered_only = yes
	location = event_target:uma_bou_ship

	option = {
		name = uma_bour_arc.3.a #wait
		hidden_effect = {
			ship_event = {
				id = uma_bour_arc.4
				days = 30
				random = 5
			}
		}
	}
	option = {
		name = uma_bour_arc.3.b #found
		owner = {
			hidden_effect = {
				set_country_flag = uma_bou_arc_b
			}
			add_resource = {
				energy = 400
			}
		}
		hidden_effect = {
			ship_event = {
				id = uma_bour_arc.4
				days = 30
				random = 5
			}
		}
	}
	option = {
		name = uma_bour_arc.3.c #Destroy them!
		owner = {
			set_country_flag = uma_bou_arc_c
		}
		hidden_effect = {
			ship_event = {
				id = uma_bour_arc.4
				days = 30
				random = 5
			}
		}
	}
}

#1
ship_event = {
	id = uma_bour_arc.4
	title = uma_bour_arc.4.title
	desc = uma_bour_arc.4.desc
	is_triggered_only = yes
	location = event_target:uma_bou_ship

	option = {
		name = uma_bour_arc.4.a

		event_target:uma_bourbon_arc_anomaly_here = {
			change_pc = pc_machine
			create_archaeological_site = uma_bourbon_arc
		}
	}
#
	option = {
		allow = {
			owner = {
				custom_tooltip = {
					has_country_flag = uma_bou_arc_b
					fail_text = uma_no_arc_b
				}
			}
		}
		name = uma_bour_arc.4.b

		event_target:uma_bourbon_arc_anomaly_here = {
			change_pc = pc_machine
			create_archaeological_site = uma_bourbon_arc
		}

	}
#3炸球
	option = {
		allow = {
			owner = {
				custom_tooltip = {
					has_country_flag = uma_bou_arc_c
					fail_text = uma_no_arc_c
				}
			}
		}
		name = uma_bour_arc.4.c
		owner = {
			enable_special_project = {
				name = UMA_BOU_BOOM_PLANET
				location = event_target:uma_bourbon_arc_anomaly_here
				owner = this
			}
		}
	}
}

##3后续
country_event = {
	id = uma_bour_arc.5
	title = uma_bour_arc.5.title
	desc = uma_bour_arc.5.desc

	option = {
		name = uma_bour_arc_damn
	}
}


###########Arc_site

fleet_event = {
	id = uma_bour_arc.6
	title = uma_bour_arc.6.title
	desc = uma_bour_arc.6.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.6.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.7
	title = uma_bour_arc.7.title
	desc = uma_bour_arc.7.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.7.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.8
	title = uma_bour_arc.8.title
	desc = uma_bour_arc.8.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.8.a
		small_artifact_reward = yes
		#感觉回不太好？
		owner = {
			add_tech_progress = {
				tech = tech_psionic_theory
				progress = 0.1
			}

#			add_modifier = {
#				modifier =
#			}
		}
	}
}

fleet_event = {
	id = uma_bour_arc.9
	title = uma_bour_arc.9.title
	desc = uma_bour_arc.9.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.9.a
		small_artifact_reward = yes
		#好多buff！
#		owner = {
#			add_modifier = {
#				modifier =
#			}
#		}
	}
}

fleet_event = {
	id = uma_bour_arc.10
	title = uma_bour_arc.10.title
	desc = uma_bour_arc.10.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = {
			set_site_progress_locked = yes
			save_global_event_target_as = uma_bourbon_arc_site
		}
	}

	after = {
#		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.10.a
		owner = {
			enable_special_project = {
				name = UMA_BOU_DECODE
				owner = this
				location = event_target:uma_bourbon_arc_anomaly_here
			}
		}

	}
	option = {
		name = uma_bour_arc.10.b
		owner = {
			enable_special_project = {
				name = UMA_BOU_DECODE_WHOLE_COUNTRY
				owner = this
				location = event_target:uma_bourbon_arc_anomaly_here
			}
		}
	}
	option = {
		name = uma_bour_arc.10.c
		save_global_event_target_as = uma_bourbon_this_is_fleet
		enable_special_project = {
			name = UMA_BOU_BOOM_PLANET_ARC
			owner = owner
			location = event_target:uma_bourbon_arc_anomaly_here
		}
	}
}

fleet_event = {
	id = uma_bour_arc.11
	title = uma_bour_arc.11.title
	desc = uma_bour_arc.11.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.11.a
		large_artifact_reward = yes
		enable_special_project = {
			name = UMA_BOU_ANALYSE
			owner = owner
			location = event_target:uma_bourbon_arc_anomaly_here
		}
	}
}



##后续

country_event = {
	id = uma_bour_arc.12
	title = uma_bour_arc.12.title
	desc = uma_bour_arc.12.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.12.a
		add_relic = uma_umamusume_datebase
	}
}


country_event = {
	id = uma_bour_arc.13
	title = uma_bour_arc.13.title
	desc = uma_bour_arc.13.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.13.a
		##?思潮？怎么加？
	}
	option = {
		name = uma_bour_arc.13.b
	}
	option = {
		name = uma_bour_arc.13.c
	}
}


##后面是一飞的事件

country_event = {
	id = uma_bour_arc.14
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_ascension_perk = ap_uma_zenshizenren
		has_ascension_perk = ap_uma_fly_me_to_the_star
	}

	immediate = {
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.15
				days = 500
			}
			country_event = {
				id = uma_bour_arc.16
				days = 500
			}
		}
	}
}

##星系生成器！！

country_event = {
	id = uma_bour_arc.15
	hide_window = yes
	is_triggered_only = yes


	immediate = {
		if = {
			limit = { count_system = { count <= 250 } } #200
			no_scope = {
				spawn_system = {
					min_distance >= 105
					max_distance <= 215
					min_orientation_angle = 20
					max_orientation_angle = 150
					initializer = "uma_bourbon_initializer"
					hyperlane = no
				}
			}
		}

		else_if = {
			limit = { count_system = { count <= 450 } }
			no_scope = {
				spawn_system = {
					min_distance >= 325
					max_distance <= 335
					min_orientation_angle = 20
					max_orientation_angle = 150
					initializer = "uma_bourbon_initializer"
					hyperlane = no
				}
			}
		}

		else_if = {
			limit = { count_system = { count <= 650 } }
			no_scope = {
				spawn_system = {
					min_distance >= 415
					max_distance <= 425
					min_orientation_angle = 20
					max_orientation_angle = 150
					initializer = "uma_bourbon_initializer"
					hyperlane = no
				}
			}
		}

		else_if = {
			limit = { count_system = { count <= 850 } }
			no_scope = {
				spawn_system = {
					min_distance >= 445
					max_distance <= 455
					min_orientation_angle = 20
					max_orientation_angle = 150
					initializer = "uma_bourbon_initializer"
					hyperlane = no
				}
			}
		}

		else = {
			no_scope = {
				spawn_system = {
					min_distance >= 475
					max_distance <= 485
					min_orientation_angle = 20
					max_orientation_angle = 150
					initializer = "uma_bourbon_initializer"
					hyperlane = no
				}
			}
		}
	}
	after = {
		random_system = {
			limit = {
				has_star_flag = uma_bourbon_system
			}
			save_global_event_target_as = uma_bourbon_system_here
		}
	}
}
country_event = {
	id = uma_bour_arc.16
	title = uma_bour_arc.16.title
	desc = uma_bour_arc.16.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.16.a
		add_resource = {
			alloys = 200
		}
		hidden_effect = {
			set_visited = event_target:uma_bourbon_system_here
		}
	}
	option = {
		name = uma_bour_arc.16.b
	}
}


fleet_event = {
	id = uma_bour_arc.17
	title = uma_bour_arc.17.title
	desc = uma_bour_arc.17.desc
	is_triggered_only = yes

	trigger = {
		from = {
			has_star_flag = uma_bourbon_system
		}
	}

	option = {
		name = uma_bour_arc.17.a
	}
	after = {
		event_target:uma_bourbon_firstap_planet = {
			add_anomaly = {
				category = uma_bourbon_anomaly_second
				target = event_target:uma_bourbon_firstap_planet
			}
		}
	}
}


ship_event = {
	id = uma_bour_arc.18
	title = uma_bour_arc.18.title
	desc = uma_bour_arc.18.desc
	is_triggered_only = yes

	immediate = {
		event_target:uma_bourbon_arc_second_here = {
			create_archaeological_site = uma_bourbon_arc_second
		}
	}
}

###考古二段
#stage1
fleet_event = {
	id = uma_bour_arc.20
	title = uma_bour_arc.20.title
	desc = uma_bour_arc.20.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.20.a
		small_artifact_reward = yes
		owner = {
			add_modifier = {
				modifier = uma_big_bug
			}
			add_resource = {
				food = 4000
			}
		}
	}
}

#stage2
fleet_event = {
	id = uma_bour_arc.21
	title = uma_bour_arc.21.title
	desc = uma_bour_arc.21.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.21.a
		small_artifact_reward = yes
	}
}
#stage3
fleet_event = {
	id = uma_bour_arc.22
	title = uma_bour_arc.22.title
	desc = uma_bour_arc.22.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.22.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.23
	title = uma_bour_arc.23.title
	desc = uma_bour_arc.23.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.23.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.24
	title = uma_bour_arc.24.title
	desc = uma_bour_arc.24.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.24.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.25
	title = uma_bour_arc.25.title
	desc = uma_bour_arc.25.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.25.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.26
	title = uma_bour_arc.26.title
	desc = uma_bour_arc.26.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.26.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = uma_bour_arc.27
	title = uma_bour_arc.27.title
	desc = uma_bour_arc.27.desc
	picture = GFX_evt_discovered_hidden_door  #快速占位图
	show_sound = archeology_log_entry_positive
	location = from
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = uma_bour_arc.27.a
		large_artifact_reward = yes
		owner = {
			country_event = {

			}
		}
	}
}

country_event = {
	id = uma_bour_arc.30
	title = uma_bour_arc.30.title
	desc = uma_bour_arc.30.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.30.a
	}
	option = {
		name = uma_bour_arc.30.b
		add_resource = {
			energy = -4000
		}
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.31
				days = 300
				random = 20
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.31
	title = uma_bour_arc.31.title
	desc = uma_bour_arc.31.desc
	is_triggered_only = yes

	option = {
		name = GOOD
	}
}

country_event = {
	id = uma_bour_arc.32
	title = uma_bour_arc.32.title
	desc = uma_bour_arc.32.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.32.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.33
				days = 730
				random = 10
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.33
	title = uma_bour_arc.33.title
	desc = uma_bour_arc.33.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.33.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.34
				days = 50
			}
		}
	}
}



##通信

country_event = {
	id = uma_bour_arc.34
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.34.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = uma_bour_arc.34.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.35
				days = 50
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.35
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.35.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = uma_bour_arc.35.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.36
				days = 50
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.36
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.36.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = uma_bour_arc.36.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.37
			}
		}
	}
	option = {
		name = uma_bour_arc.36.b
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.38
				days = 50
			}
		}
		add_resource = {
			alloys = -400
			energy = -200
		}
	}
}

country_event = {
	id = uma_bour_arc.37
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.37.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = uma_bour_arc.37.a
	}
	option = {
		name = uma_bour_arc.37.b
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.38
				days = 50
			}
		}
		add_resource = {
			alloys = -400
			energy = -200
		}
	}
}

country_event = {
	id = uma_bour_arc.38
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.38.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	option = {
		name = uma_bour_arc.38.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.39
				days = 50
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.39
	title = uma_bour_arc.unknow
	desc = uma_bour_arc.39.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = shroudwalkers_room
		portrait = BOURBON_COMM
	}

	option = {
		name = uma_bour_arc.39.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.40
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.40
	title = uma_bour_arc.k
	desc = uma_bour_arc.40.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = shroudwalkers_room
		portrait = BOURBON_COMM
	}

	option = {
		name = uma_bour_arc.40.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.41
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.41
	title = uma_bour_arc.k
	desc = uma_bour_arc.41.desc
	is_triggered_only = yes
	diplomatic = yes

	picture_event_data = {
		room = shroudwalkers_room
		portrait = BOURBON_COMM
	}

	option = {
		name = uma_bour_arc.41.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.42
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.42
	title = uma_bour_arc.k
	desc = uma_bour_arc.42.desc
	is_triggered_only = yes

	option = {
		name = uma_bour_arc.42.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.43
			}
		}
	}
}

country_event = {
	id = uma_bour_arc.43
	title = uma_bour_arc.k
	desc = uma_bour_arc.43.desc
	is_triggered_only = yes


	option = {
		name = uma_bour_arc.43.a
		hidden_effect = {
			country_event = {
				id = uma_bour_arc.44
			}
		}
	}
}

